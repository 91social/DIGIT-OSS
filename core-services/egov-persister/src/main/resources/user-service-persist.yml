serviceMaps:
  serviceName: User Service
  mappings:
    - version: 1.0
      name: User
      description: create UserCompleteDetails in eg_user, eg_user_details and eg_userrole
      fromTopic: user-save-topic
      isTransaction : true
      queryMaps:
        - query: INSERT INTO eg_user(id, salutation, locale, username, password, pwdexpirydate, mobilenumber, emailid, name, gender, aadhaarnumber, type, active, accountlocked, tenantid, createdby, lastmodifiedby, createddate, lastmodifieddate) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.users.*
          jsonMaps:
            - jsonPath: $.users.*.id

            - jsonPath: $.users.*.salutation

            - jsonPath: $.users.*.locale

            - jsonPath: $.users.*.userName

            - jsonPath: $.users.*.password

            - jsonPath: $.users.*.pwdExpiryDate

            - jsonPath: $.users.*.mobileNumber

            - jsonPath: $.users.*.emailId

            - jsonPath: $.users.*.name

            - jsonPath: $.users.*.gender

            - jsonPath: $.users.*.aadhaarNumber

            - jsonPath: $.users.*.type

            - jsonPath: $.users.*.active

            - jsonPath: $.users.*.accountLocked

            - jsonPath: $.users.*.tenantId

            - jsonPath: $.users.*.auditDetails.createdBy

            - jsonPath: $.users.*.auditDetails.lastModifiedBy

            - jsonPath: $.users.*.auditDetails.createdDate

            - jsonPath: $.users.*.auditDetails.lastModifiedDate

        - query : INSERT INTO eg_user_details(userid, tenantid, firstname, middlename, lastname, dob, altcontactnumber, bloodgroup, pan, identificationmark, signature) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.users.*.userDetails
          jsonMaps:
            - jsonPath: $.users.*.id

            - jsonPath: $.users.*.tenantId

            - jsonPath: $.users.*.userDetails.firstName

            - jsonPath: $.users.*.userDetails.middleName

            - jsonPath: $.users.*.userDetails.lastName

            - jsonPath: $.users.*.userDetails.dob

            - jsonPath: $.users.*.userDetails.altContactNumber

            - jsonPath: $.users.*.userDetails.bloodGroup

            - jsonPath: $.users.*.userDetails.pan

            - jsonPath: $.users.*.userDetails.identificationMark

            - jsonPath: $.users.*.userDetails.signature

        - query : INSERT INTO eg_user_address(id, createddate, createdby, type, address, city, pincode, userid, tenantid) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.users.*.userDetails.addresses.*
          jsonMaps:
            - jsonPath: $.users.*.userDetails.addresses.*.id

            - jsonPath: $.users.*.userDetails.addresses.*.createdDate

            - jsonPath: $.users.*.userDetails.addresses.*.createdBy

            - jsonPath: $.users.*.userDetails.addresses.*.addressType

            - jsonPath: $.users.*.userDetails.addresses.*.address

            - jsonPath: $.users.*.userDetails.addresses.*.city

            - jsonPath: $.users.*.userDetails.addresses.*.pinCode

            - jsonPath: $.users.*.userDetails.addresses.*.userId

            - jsonPath: $.users.*.userDetails.addresses.*.tenantId

        - query : INSERT INTO eg_userrole(id, name, code, createdby, userid, tenantid, lastmodifieddate) VALUES (?, ?, ?, ?, ?, ?, ?);
          basePath: $.users.*.roles.*
          jsonMaps:
            - jsonPath: $.users.*.roles.*.id

            - jsonPath: $.users.*.roles.*.name

            - jsonPath: $.users.*.roles.*.code

            - jsonPath: $.users.*.roles.*.createdBy

            - jsonPath: $.users.*.roles.*.userId

            - jsonPath: $.users.*.roles.*.tenantId

            - jsonPath: $.users.*.roles.*.lastModifiedDate

    - version: 1.0
      name: User
      description: create user otp
      fromTopic: userotp-save-topic
      isTransaction : true
      queryMaps:
        - query: INSERT INTO eg_user_otp(userid, tenantid, otpnumber, otpidentity, validated, createddate,lastmodifieddate, createdby, lastmodifiedby) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);

          basePath: $.otp
          jsonMaps:
            - jsonPath: $.otp.userId

            - jsonPath: $.otp.tenantId

            - jsonPath: $.otp.otpNumber

            - jsonPath: $.otp.mobileNumber

            - jsonPath: $.otp.validated

            - jsonPath: $.otp.auditDetails.createdDate

            - jsonPath: $.otp.auditDetails.lastModifiedDate

            - jsonPath: $.otp.auditDetails.createdBy

            - jsonPath: $.otp.auditDetails.lastModifiedBy

    - version: 1.0
      name: User
      description: update user otp as password
      fromTopic: userpassword-update-topic
      isTransaction : true
      queryMaps:
        - query: update eg_user set password=?,lastmodifiedby=?,lastmodifieddate=? where tenantid=? and username=?

          basePath: $
          jsonMaps:
            - jsonPath: $.password

            - jsonPath: $.auditDetails.lastModifiedBy

            - jsonPath: $.auditDetails.lastModifiedDate

            - jsonPath: $.tenantId

            - jsonPath: $.userName
